FROM python:3.8-slim-buster

RUN apt-get update && apt-get install -y --no-install-recommends \
  bash nginx

# set Python virtual environment and PATH environment variable
RUN python3 -m venv /home/venv
ENV PATH="/home/venv/bin:$PATH"

RUN pip install --no-cache-dir numpy pandas scikit-learn==0.24.2 \
  flask gevent gunicorn

# Set current working directory
WORKDIR /opt/app

COPY .serving_tmp/serving/* ./
COPY .serving_tmp/model_training ./model_training

CMD [ "python3", "/opt/app/server.py" ]
